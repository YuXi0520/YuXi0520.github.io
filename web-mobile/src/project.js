require=function n(c,h,a){function d(e,t){if(!h[e]){if(!c[e]){var i="function"==typeof require&&require;if(!t&&i)return i(e,!0);if(_)return _(e,!0);var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}var o=h[e]={exports:{}};c[e][0].call(o.exports,function(t){return d(c[e][1][t]||t)},o,o.exports,n,c,h,a)}return h[e].exports}for(var _="function"==typeof require&&require,t=0;t<a.length;t++)d(a[t]);return d}({HelloWorld:[function(t,e,i){"use strict";cc._RF.push(e,"280c3rsZJJKnZ9RqbALVwtK","HelloWorld"),cc.Class({extends:cc.Component,properties:{label:{default:null,type:cc.Label},text:"Hello, World!"},onLoad:function(){this.label.string=this.text},update:function(t){}}),cc._RF.pop()},{}],JoystickBG:[function(t,e,i){"use strict";cc._RF.push(e,"3ef7bqFNXZK6J2fQJpZ8PKp","JoystickBG");var s=t("JoystickBar");cc.Class({extends:cc.Component,properties:{dot:{default:null,type:cc.Node,displayName:"摇杆节点"},_joyCom:{default:null,displayName:"joy Node"},_playerNode:{default:null,displayName:"被操作的目标Node"},_angle:{default:null,displayName:"当前触摸的角度"},_radian:{default:null,displayName:"弧度"},_speed:0,_speed1:1,_speed2:2,_opacity:0},onLoad:function(){this._joyCom=this.node.parent.getComponent("Joystick"),this._playerNode=this._joyCom.sprite,this._joyCom.touchType==s.TouchType.DEFAULT&&this._initTouchEvent()},_initTouchEvent:function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,this._touchStartEvent,t),t.node.on(cc.Node.EventType.TOUCH_MOVE,this._touchMoveEvent,t),t.node.on(cc.Node.EventType.TOUCH_END,this._touchEndEvent,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,this._touchEndEvent,t)},update:function(t){switch(this._joyCom.directionType){case s.DirectionType.FOUR:this._fourDirectionsMove();break;case s.DirectionType.EIGHT:this._eightDirectionsMove();break;case s.DirectionType.ALL:this._allDirectionsMove()}},_fourDirectionsMove:function(){45<this._angle&&this._angle<135?this._playerNode.y+=this._speed:-135<this._angle&&this._angle<-45?this._playerNode.y-=this._speed:this._angle<-135&&-180<this._angle||135<this._angle&&this._angle<180?this._playerNode.x-=this._speed:(this._angle<0&&-45<this._angle||0<this._angle&&this._angle<45)&&(this._playerNode.x+=this._speed)},_eightDirectionsMove:function(){67.5<this._angle&&this._angle<112.5?this._playerNode.y+=this._speed:-112.5<this._angle&&this._angle<-67.5?this._playerNode.y-=this._speed:this._angle<-157.5&&-180<this._angle||157.5<this._angle&&this._angle<180?this._playerNode.x-=this._speed:this._angle<0&&-22.5<this._angle||0<this._angle&&this._angle<22.5?this._playerNode.x+=this._speed:112.5<this._angle&&this._angle<157.5?(this._playerNode.x-=this._speed/1.414,this._playerNode.y+=this._speed/1.414):22.5<this._angle&&this._angle<67.5?(this._playerNode.x+=this._speed/1.414,this._playerNode.y+=this._speed/1.414):-157.5<this._angle&&this._angle<-112.5?(this._playerNode.x-=this._speed/1.414,this._playerNode.y-=this._speed/1.414):-67.5<this._angle&&this._angle<-22.5&&(this._playerNode.x+=this._speed/1.414,this._playerNode.y-=this._speed/1.414)},_allDirectionsMove:function(){this._playerNode.x+=Math.cos(this._angle*(Math.PI/180))*this._speed,this._playerNode.y+=Math.sin(this._angle*(Math.PI/180))*this._speed},_getDistance:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},_getRadian:function(t){return this._radian=Math.PI/180*this._getAngle(t),this._radian},_getAngle:function(t){var e=this.node.getPosition();return this._angle=Math.atan2(t.y-e.y,t.x-e.x)*(180/Math.PI),this._angle},_setSpeed:function(t){this._getDistance(t,this.node.getPosition())<this._radius?this._speed=this._speed1:this._speed=this._speed2},_touchStartEvent:function(t){var e=this.node.convertToNodeSpaceAR(t.getLocation()),i=this._getDistance(e,cc.p(0,0)),s=this.node.width/2;this._stickPos=e;var o=this.node.getPosition().x+e.x,n=this.node.getPosition().y+e.y;return i<s&&(this.dot.setPosition(cc.p(o,n)),!0)},_touchMoveEvent:function(t){var e=this.node.convertToNodeSpaceAR(t.getLocation()),i=this._getDistance(e,cc.p(0,0)),s=this.node.width/2,o=this.node.getPosition().x+e.x,n=this.node.getPosition().y+e.y;if(i<s)this.dot.setPosition(cc.p(o,n));else{var c=this.node.getPosition().x+Math.cos(this._getRadian(cc.p(o,n)))*s,h=this.node.getPosition().y+Math.sin(this._getRadian(cc.p(o,n)))*s;this.dot.setPosition(cc.p(c,h))}this._getAngle(cc.p(o,n)),this._setSpeed(cc.p(o,n))},_touchEndEvent:function(){this.dot.setPosition(this.node.getPosition()),this._speed=0}}),cc._RF.pop()},{JoystickBar:"JoystickBar"}],JoystickBar:[function(t,e,i){"use strict";cc._RF.push(e,"2186aWU3xpOyKhRUQhqj5qU","JoystickBar"),e.exports={TouchType:cc.Enum({DEFAULT:0,FOLLOW:1}),DirectionType:cc.Enum({FOUR:4,EIGHT:8,ALL:0})},cc._RF.pop()},{}],Joystick:[function(t,e,i){"use strict";cc._RF.push(e,"36aa5e7xdRBh4OA13/mQtIs","Joystick");var s=t("JoystickBar"),o=t("JoystickBG");cc.Class({extends:cc.Component,properties:{dot:{default:null,type:cc.Node,displayName:"摇杆节点"},ring:{default:null,type:o,displayName:"摇杆背景节点"},stickX:{default:0,displayName:"摇杆X位置"},stickY:{default:0,displayName:"摇杆Y位置"},touchType:{default:s.TouchType.DEFAULT,type:s.TouchType,displayName:"触摸类型"},directionType:{default:s.DirectionType.ALL,type:s.DirectionType,displayName:"方向类型"},sprite:{default:null,type:cc.Node,displayName:"操控的目标"},_stickPos:{default:null,type:cc.Node,displayName:"摇杆当前位置"},_touchLocation:{default:null,type:cc.Node,displayName:"摇杆当前位置"}},onLoad:function(){this._createStickSprite(),this.touchType==s.TouchType.FOLLOW&&this._initTouchEvent()},_createStickSprite:function(){this.ring.node.setPosition(this.stickX,this.stickY),this.dot.setPosition(this.stickX,this.stickY)},_initTouchEvent:function(){var t=this;t.node.on(cc.Node.EventType.TOUCH_START,t._touchStartEvent,t),t.node.on(cc.Node.EventType.TOUCH_MOVE,t._touchMoveEvent,t),t.node.on(cc.Node.EventType.TOUCH_END,t._touchEndEvent,t),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t._touchEndEvent,t)},_touchStartEvent:function(t){this._touchLocation=t.getLocation();var e=this.node.convertToNodeSpaceAR(t.getLocation());this.ring.node.setPosition(e),this.dot.setPosition(e),this._stickPos=e},_touchMoveEvent:function(t){if(this._touchLocation.x==t.getLocation().x&&this._touchLocation.y==t.getLocation().y)return!1;var e=this.ring.node.convertToNodeSpaceAR(t.getLocation()),i=this.ring._getDistance(e,cc.p(0,0)),s=this.ring.node.width/2,o=this._stickPos.x+e.x,n=this._stickPos.y+e.y;if(i<s)this.dot.setPosition(cc.p(o,n));else{var c=this._stickPos.x+Math.cos(this.ring._getRadian(cc.p(o,n)))*s,h=this._stickPos.y+Math.sin(this.ring._getRadian(cc.p(o,n)))*s;this.dot.setPosition(cc.p(c,h))}this.ring._getAngle(cc.p(o,n)),this.ring._setSpeed(cc.p(o,n))},_touchEndEvent:function(){this.dot.setPosition(this.ring.node.getPosition()),this.ring._speed=0}}),cc._RF.pop()},{JoystickBG:"JoystickBG",JoystickBar:"JoystickBar"}]},{},["HelloWorld","Joystick","JoystickBG","JoystickBar"]);